---
title: IUnderwriterManager
description: Interface for managing capital allocation across underwriting pools.
---

<Callout type="info">
  View deployed contract addresses in the [Contract Addresses](/resources/contract-addresses) section.
</Callout>

The **IUnderwriterManager** serves as the central registry for capital allocation. It tracks how much capital each underwriter (Syndicate) has pledged to each pool and enforces capacity limits.

## Interface

```solidity
// SPDX-License-Identifier: BUSL-1.1
pragma solidity ^0.8.20;

import {Types} from "../libraries/helpers/Types.sol";

/**
 * @title IUnderwriterManager
 * @notice Unified interface for UnderwriterManager - includes both public API and coordination functions
 */
interface IUnderwriterManager {
    /* =============================
       ===== Views (Public API) =====
       ============================= */
    
    function poolAllocationManager() external view returns (address);
    function intentMatcher() external view returns (address);
    function getUnderwriterAllocations(address user) external view returns (uint256[] memory);
    function getPledge(address user, uint256 poolId) external view returns (uint256);
    function getPoolPayoutData(uint256 poolId)
        external
        view
        returns (address[] memory adapters, uint256[] memory capitalPerAdapter, uint256 totalCapital);
    function getPoolUnderwriterCount(uint256 poolId) external view returns (uint256);
    function getCapitalPendingWithdrawal(uint256 poolId) external view returns (uint256);
    function getPoolCapitalHeadroom(uint256 poolId) external view returns (uint256 activeCapital, uint256 availableCoverage);
    function getActivePledgeForRewards(address user, uint256 poolId) external view returns (uint256);
    function getTotalCapitalPledgedToPool(uint256 poolId) external view returns (uint256);
    function isAllocatedToPool(address user, uint256 poolId) external view returns (bool);

    /* ================================
       ===== Intent Matcher Hooks =====
       ================================ */
    
    function allocateIntentCapital(
        address underwriter,
        uint256 poolId,
        uint256 coverageAmount,
        uint32 coverageDuration,
        bytes32 reservationKey
    ) external returns (uint256 reservedShares);
    
    function releaseIntentCapital(
        address underwriter,
        uint256 poolId,
        uint256 coverageAmount,
        bytes32 reservationKey
    ) external;

    function transitionIntentToPolicy(
        address underwriter,
        uint256 poolId,
        uint256 coverageAmount
    ) external;

    function releaseSyndicateReservation(
        address underwriter,
        uint256 coverageAmount,
        bytes32 reservationKey
    ) external;

    /* ======================================
       ===== Hooks from CapitalPool/System =====
       ====================================== */
    
    function onCapitalDeposited(address underwriter, uint256 amount) external;
    function onCapitalWithdrawn(address underwriter, uint256 principalComponentRemoved, bool isFullWithdrawal) external;
    function onLossRealized(address underwriter, uint256 principalComponentReduced) external;

    /* ====================================
       ===== Helper Contract Addresses =====
       ==================================== */
    
    function getIntentAllocationsContract() external view returns (address);

    /* ====================
       ===== Admin =====
       ==================== */
    
    function setMaxAllocationsPerUnderwriter(uint256 _newMax) external;
    function setPoolMutexGroup(uint256[] calldata poolIds, uint256 groupId) external;
    function setSyndicateFactory(address _syndicateFactory) external;
    function setPoolAllocationManager(address _poolAllocationManager) external;
    function setMaxLeverageRatio(uint256 newRatio) external;
    function setIntentMatcher(address matcher) external;
    function setIntentOrderBook(address orderBook) external;
    function setSyndicateDepositCap(address syndicate, uint256 cap) external;

    /* =========================================
       ===== Coordination (PoolAllocationManager) =====
       ========================================= */

    /// @notice Validates pool allocation constraints (risk points, mutex groups, allocation limits)
    function validatePoolAllocation(
        address underwriter,
        uint256[] memory poolIds,
        uint256[] memory amounts
    ) external view;

    /// @notice Records a new pool allocation in shared state
    function recordPoolAllocation(
        address underwriter,
        uint256 poolId,
        uint256 amount,
        address adapter
    ) external;

    /// @notice Records a pool deallocation in shared state
    function recordPoolDeallocation(
        address underwriter,
        uint256 poolId,
        uint256 deallocAmount,
        uint256 newPledge,
        address adapter
    ) external;

    /// @notice Pulls assets from the underwriter and deposits them into the CapitalPool
    function depositForUnderwriter(
        address underwriter,
        uint256 amount,
        Types.YieldPlatform yieldChoice
    ) external;

    /// @notice Removes underwriter from pool tracking completely
    function removeUnderwriterFromPool(address underwriter, uint256 poolId) external;

    /// @notice Settles rewards for a specific pool with exact time cut
    function settleRewardsSingleCut(
        address user,
        uint256 poolId,
        uint256 basePledge,
        uint48 cutTime,
        uint256 postCutPledge
    ) external;

    /// @notice Settles all rewards for a user across all pools
    function settleAllUserRewards(address user) external;

    /// @notice Gets user's available capital in a pool (pledge - locked - reserved)
    function getAvailableCapital(address user, uint256 poolId) external view returns (uint256);

    /// @notice Gets risk points used by a user
    function getUnderwriterRiskPointsUsed(address user) external view returns (uint256);

    /// @notice Gets CapitalPool address
    function getCapitalPool() external view returns (address);

    /// @notice Gets PoolRegistry address
    function getPoolRegistry() external view returns (address);

    /// @notice Gets RewardDistributor address
    function getRewardDistributor() external view returns (address);

    /// @notice Gets max allocations per underwriter
    function getMaxAllocationsPerUnderwriter() external view returns (uint256);
}
```